\section{Introduction}
\label{sec-intro}
Most modern systems are built with the disk or SSDs as the persistent storage medium and the DRAM for temporary fast byte-addressable memory usage. The data that resides in volatile memory can be lost on crashes or power failure. With the emergence of modern storage technologies and new byte addressable persistent memory technologies with much lower \textit{write} and \textit{read} latencies compared to the flash memory, it is imperative that future systems will move towards the usage of byte-addressable Non Volatile Memory (NVM) as the primary storage, with the disk as the secondary storage medium. There has always been a trade-off between data durability and data read/write performance when deciding between a fast, volatile storage medium like DRAM versus a slow, persistent storage medium like disk. Persistent memory technologies like phase change spin-torque transfer RAM (STT-RAM), phase change memory (PCM), resistive RAM (ReRAM), and 3D XPoint memory technology can solve both of these problems.

One of the earliest file systems to be proposed for non-volatile memory systems was the byte-addressable persistent file system (BPFS) \cite{c10}. \cite{c10} showed that simply running a disk-based traditional file system on top of persistent memory is not enough to provide high performance. It proposes a tree based data structure to store the file system meta data and also assumes that the hardware is capable of providing in place atomic updates of 8 bytes. It also introduces a new technique called short-circuit shadow paging to perform consistent updates to metadata, that is similar to the copy-on-write. BPFS achieves fine-grained access to persistent data at a much improved performance, while also providing strong reliability and safety guarantees. But since BPFS has been built primarily for a system with NVM as the only persistent store, the cost-per-byte of NVM potentially hinders such a filesystem from being used in common systems that do not contain sufficient NVM storage capacity. Hence, AC-BPFS builds on the existing BPFS implentation thus leveraging the benefits of BPFS, and also provides a modified file system that outperforms existing file system implementations in the presence of a storage tier that consists of both NVM and disk or flash.

Since the capacity of NVM is limited and all the data blocks cannot be stored in NVM, we explore the usage of Anti-Caching \cite{c13} as a mechanism to move data blocks between NVM and disk. The primary motivation of using Anti-Caching is to reduce \textit{write} latencies, as all writes are write-back and are persisted in NVM; but at the same time it must not worsen the read performance, due to any additional overhead. An Anti-Cache system uses memory as the primary storage and disks as the secondary storage and is designed to “evict” “cold” data actively. It has only one copy of the data, which is either in NVM or on disk. It thus entails the storage of the more frequently accessed data blocks in NVM and stores the rest of the blocks on disk or flash. In addition to Anti-Caching, we also move blocks that are read from disk to NVM. This approach is very similar to the virtual memory swapping in operating systems wherein when the amount of data exceeds available memory, cold blocks are written to disk, giving an impression to the file system that the amount of memory in NVM is virtually infinite, along with providing the best possible performance with the amount of NVM available.

AC-BPFS provides a flexible file system design that scales well irrespective of the size of the storage tier, i.e capacity of NVM and capacity of disk or flash. Its modular implementation permits users to modify individual components and apply different policies for anti-caching and disk management depending on the requirement.

There are two primary contribution of this paper. First, it describes a new approach to building a tiered filesystem, where  filesystem operations are restricted to only the fastest layer of memory and the anti-caching strategy is used to extend the storage capacity of the overall filesystem. Second, we demonstrate a working prototype of such a system that delivers comparable performance of the existing in-memory filesystem for different filesystem operations.

Section 2 provides some background information on BPFS and anti-caching- the two main ideas on which this paper builds up. Section 3 discusses the design and implementation of our proposed filesystem AC-BPFS. In Section 4, we evaluate the performance of AC-BPFS against BPFS and \textit{ext4} and present detailed analysis from our various experiments. We cover the related work in Section 5, while Section 6 concludes the paper with possible directions for future work in Section 7.
